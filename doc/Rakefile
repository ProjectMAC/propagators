def rstify filename
  file "#{filename}.html" => ["#{filename}.rst", "style.css"] do
    sh "rst2html --stylesheet style.css #{filename}.rst > #{filename}.html"
  end
  task :doc => "#{filename}.html"
end

file "revised.rst" => "revised.txt" do
  sh "cp revised.txt revised.rst"
end

# file "revised.tex" => "revised.rst" do
#   sh "rst2latex revised.rst | perl -e 'while (<>) { s/a4paper/letterpaper/; print }' > revised.tex"
# end

file "revised.dvi" => "revised.tex" do
  sh "latex revised.tex"
end

file "revised.ps" => "revised.dvi" do
  sh "dvips -o revised.ps -t letter revised"
end

file "revised.pdf" => "revised.ps" do
  sh "ps2pdf revised.ps"
end

rstify "programmer-guide"
rstify "revised"

task :doc => "revised.pdf"
